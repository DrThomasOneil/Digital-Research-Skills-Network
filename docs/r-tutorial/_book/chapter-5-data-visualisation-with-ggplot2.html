<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5: Data Visualisation with ggplot2 | Introduction to R and analytic Programming</title>
  <meta name="description" content="Chapter 5: Data Visualisation with ggplot2 | Introduction to R and analytic Programming" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5: Data Visualisation with ggplot2 | Introduction to R and analytic Programming" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="DrThomasOneil/analysis-user-group" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5: Data Visualisation with ggplot2 | Introduction to R and analytic Programming" />
  
  
  

<meta name="author" content="Yuchen Li &amp; Thomas O’Neil" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-4-data-manipulation-with-tidyverse.html"/>
<link rel="next" href="chapter-6-data-visualisation-with-ggplot2-2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to R and analytic Programming</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome!</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#transitioning-from-manual-tools-e.g.-excel-prism-to-programming-based-workflows-in-r."><i class="fa fa-check"></i>Transitioning from manual tools (e.g. Excel &amp; Prism) to programming-based workflows in R.</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#handling-data---be-specific"><i class="fa fa-check"></i>Handling data - be specific!</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#directories"><i class="fa fa-check"></i>Directories</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#reproducibility-and-automation"><i class="fa fa-check"></i>Reproducibility and automation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-1-getting-started-in-r-and-rstudio.html"><a href="chapter-1-getting-started-in-r-and-rstudio.html"><i class="fa fa-check"></i>Chapter 1: Getting Started in R and RStudio</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-1-getting-started-in-r-and-rstudio.html"><a href="chapter-1-getting-started-in-r-and-rstudio.html#r-as-a-programming-language"><i class="fa fa-check"></i>R as a programming language</a></li>
<li class="chapter" data-level="" data-path="chapter-1-getting-started-in-r-and-rstudio.html"><a href="chapter-1-getting-started-in-r-and-rstudio.html#installing-r-and-rstudio"><i class="fa fa-check"></i>Installing R and RStudio</a></li>
<li class="chapter" data-level="" data-path="chapter-1-getting-started-in-r-and-rstudio.html"><a href="chapter-1-getting-started-in-r-and-rstudio.html#navigating-rstudio"><i class="fa fa-check"></i>Navigating RStudio</a></li>
<li class="chapter" data-level="" data-path="chapter-1-getting-started-in-r-and-rstudio.html"><a href="chapter-1-getting-started-in-r-and-rstudio.html#projects"><i class="fa fa-check"></i>Projects</a></li>
<li class="chapter" data-level="" data-path="chapter-1-getting-started-in-r-and-rstudio.html"><a href="chapter-1-getting-started-in-r-and-rstudio.html#using-r"><i class="fa fa-check"></i>Using R</a></li>
<li class="chapter" data-level="" data-path="chapter-1-getting-started-in-r-and-rstudio.html"><a href="chapter-1-getting-started-in-r-and-rstudio.html#hello-world"><i class="fa fa-check"></i>Hello World</a></li>
<li class="chapter" data-level="" data-path="chapter-1-getting-started-in-r-and-rstudio.html"><a href="chapter-1-getting-started-in-r-and-rstudio.html#exercise-write-your-first-second-script"><i class="fa fa-check"></i>Exercise: Write your <strike>first</strike> second script</a></li>
<li class="chapter" data-level="" data-path="chapter-1-getting-started-in-r-and-rstudio.html"><a href="chapter-1-getting-started-in-r-and-rstudio.html#next-chapter"><i class="fa fa-check"></i>Next Chapter</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-2-data-types-and-structures.html"><a href="chapter-2-data-types-and-structures.html"><i class="fa fa-check"></i>Chapter 2: Data Types and Structures</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-2-data-types-and-structures.html"><a href="chapter-2-data-types-and-structures.html#data-types"><i class="fa fa-check"></i>Data Types</a></li>
<li class="chapter" data-level="" data-path="chapter-2-data-types-and-structures.html"><a href="chapter-2-data-types-and-structures.html#data-structures"><i class="fa fa-check"></i>Data Structures</a></li>
<li class="chapter" data-level="" data-path="chapter-2-data-types-and-structures.html"><a href="chapter-2-data-types-and-structures.html#importing-and-saving-files-in-r"><i class="fa fa-check"></i>Importing and saving files in R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-3-basic-programming.html"><a href="chapter-3-basic-programming.html"><i class="fa fa-check"></i>Chapter 3: Basic Programming</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-3-basic-programming.html"><a href="chapter-3-basic-programming.html#assigning-variables"><i class="fa fa-check"></i>Assigning variables</a></li>
<li class="chapter" data-level="" data-path="chapter-3-basic-programming.html"><a href="chapter-3-basic-programming.html#conditional-statements"><i class="fa fa-check"></i>Conditional statements</a></li>
<li class="chapter" data-level="" data-path="chapter-3-basic-programming.html"><a href="chapter-3-basic-programming.html#loops"><i class="fa fa-check"></i>Loops</a></li>
<li class="chapter" data-level="" data-path="chapter-3-basic-programming.html"><a href="chapter-3-basic-programming.html#writing-a-function"><i class="fa fa-check"></i>Writing a function</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-4-data-manipulation-with-tidyverse.html"><a href="chapter-4-data-manipulation-with-tidyverse.html"><i class="fa fa-check"></i>Chapter 4: Data Manipulation with <code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="" data-path="chapter-4-data-manipulation-with-tidyverse.html"><a href="chapter-4-data-manipulation-with-tidyverse.html#why-use-tidyverse"><i class="fa fa-check"></i>Why use tidyverse</a></li>
<li class="chapter" data-level="" data-path="chapter-4-data-manipulation-with-tidyverse.html"><a href="chapter-4-data-manipulation-with-tidyverse.html#filtering-rows-and-columns"><i class="fa fa-check"></i>Filtering rows and columns</a></li>
<li class="chapter" data-level="" data-path="chapter-4-data-manipulation-with-tidyverse.html"><a href="chapter-4-data-manipulation-with-tidyverse.html#adding-a-column-using-mutate"><i class="fa fa-check"></i>Adding a column using <code>mutate()</code></a></li>
<li class="chapter" data-level="" data-path="chapter-4-data-manipulation-with-tidyverse.html"><a href="chapter-4-data-manipulation-with-tidyverse.html#group_by-and-summarize"><i class="fa fa-check"></i><code>group_by()</code> and <code>summarize()</code></a></li>
<li class="chapter" data-level="" data-path="chapter-4-data-manipulation-with-tidyverse.html"><a href="chapter-4-data-manipulation-with-tidyverse.html#pivot"><i class="fa fa-check"></i>Pivot</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-4-data-manipulation-with-tidyverse.html"><a href="chapter-4-data-manipulation-with-tidyverse.html#hopefully-it-is-clear-why-tidyverse-is-a-useful-tool."><i class="fa fa-check"></i>Hopefully it is clear why <code>tidyverse</code> is a useful tool.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-5-data-visualisation-with-ggplot2.html"><a href="chapter-5-data-visualisation-with-ggplot2.html"><i class="fa fa-check"></i>Chapter 5: Data Visualisation with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="" data-path="chapter-5-data-visualisation-with-ggplot2.html"><a href="chapter-5-data-visualisation-with-ggplot2.html#basics-of-ggplot2"><i class="fa fa-check"></i>Basics of ggplot2</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-5-data-visualisation-with-ggplot2.html"><a href="chapter-5-data-visualisation-with-ggplot2.html#scatterplot"><i class="fa fa-check"></i>Scatterplot</a></li>
<li class="chapter" data-level="" data-path="chapter-5-data-visualisation-with-ggplot2.html"><a href="chapter-5-data-visualisation-with-ggplot2.html#boxplot"><i class="fa fa-check"></i>Boxplot</a></li>
<li class="chapter" data-level="" data-path="chapter-5-data-visualisation-with-ggplot2.html"><a href="chapter-5-data-visualisation-with-ggplot2.html#columnbar-graph"><i class="fa fa-check"></i>Column/bar graph</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-5-data-visualisation-with-ggplot2.html"><a href="chapter-5-data-visualisation-with-ggplot2.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-6-data-visualisation-with-ggplot2-2.html"><a href="chapter-6-data-visualisation-with-ggplot2-2.html"><i class="fa fa-check"></i>Chapter 6: Data Visualisation with <code>ggplot2</code> 2</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-6-data-visualisation-with-ggplot2-2.html"><a href="chapter-6-data-visualisation-with-ggplot2-2.html#adjusting-theme-elements"><i class="fa fa-check"></i>Adjusting theme elements</a></li>
<li class="chapter" data-level="" data-path="chapter-6-data-visualisation-with-ggplot2-2.html"><a href="chapter-6-data-visualisation-with-ggplot2-2.html#annotating-the-plot"><i class="fa fa-check"></i>Annotating the plot</a></li>
<li class="chapter" data-level="" data-path="chapter-6-data-visualisation-with-ggplot2-2.html"><a href="chapter-6-data-visualisation-with-ggplot2-2.html#facet_wrap-and-group"><i class="fa fa-check"></i>facet_wrap() and Group</a></li>
<li class="chapter" data-level="" data-path="chapter-6-data-visualisation-with-ggplot2-2.html"><a href="chapter-6-data-visualisation-with-ggplot2-2.html#saving-plots"><i class="fa fa-check"></i>Saving plots</a></li>
<li class="chapter" data-level="" data-path="chapter-6-data-visualisation-with-ggplot2-2.html"><a href="chapter-6-data-visualisation-with-ggplot2-2.html#some-final-hints"><i class="fa fa-check"></i>Some final hints</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-7-statistical-analysis.html"><a href="chapter-7-statistical-analysis.html"><i class="fa fa-check"></i>Chapter 7: Statistical Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="chapter-7-statistical-analysis.html"><a href="chapter-7-statistical-analysis.html#descriptive-statistics"><i class="fa fa-check"></i>Descriptive statistics</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="chapter-8-reproducible-reports-with-rmarkdown.html"><a href="chapter-8-reproducible-reports-with-rmarkdown.html"><i class="fa fa-check"></i>Chapter 8: Reproducible Reports with RMarkdown</a></li>
<li class="chapter" data-level="" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i>Conclusions</a></li>
<li class="divider"></li>
<li><a href="https://drthomasoneil.github.io/analysis-user-group" target="blank"><i><strong>Return to the analysis page!</strong></i></a></li>
<li><a href="https://github.com/DrThomasOneil/analysis-user-group/tree/main/docs/r-tutorial" target="blank">See The Source Code</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R and analytic Programming</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter-5-data-visualisation-with-ggplot2" class="section level1 hasAnchor">
<h1>Chapter 5: Data Visualisation with <code>ggplot2</code><a href="chapter-5-data-visualisation-with-ggplot2.html#chapter-5-data-visualisation-with-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="hint-goals">
<p><strong>Goals:</strong><br />
Create and customize visualizations using <code>ggplot2</code>.<br />
  • Basics of <code>ggplot2</code><br />
  • Make a scatterplot, boxplot and column graph<br />
  • Customise labels, themes, and colors.</p>
</div>
<p>R is a powerful tool for visualisation. Base R has its own graphing functions, but it’s. honestly a bit too simple and ugly for publication. <strong><em>ggplot2</em></strong> is perhaps the most commonly used package. A more detailed resource can be found <a href="https://ggplot2-book.org/introduction">here</a>.</p>
<p>ggplot will be split across two chapters. The first will be the fundamentals for making figures, and the next chapter will have notes on detailed customisations.</p>
<p><read-time><i><strong>Read time</strong>: 20 Minutes</i></read-time></p>
<p><wimr></p>
<div id="basics-of-ggplot2" class="section level2 hasAnchor">
<h2>Basics of ggplot2<a href="chapter-5-data-visualisation-with-ggplot2.html#basics-of-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ggplot2 is simply an expansive toolbox of graphics and functions that you may combine in infinitely unique ways to create figures for your specific needs and liking.</p>
<p>The design of a ggplot graphic is that it is built in layers:</p>
<ol style="list-style-type: decimal">
<li><strong>Start with the raw input data</strong>: which object will you use? Which columns will be on the x, y, will be grouped, will be used for colours?<br />
</li>
<li><strong>Next, define how the data will be plotted</strong> - scatterplot, violin, column, boxplot, heatmap, density etc.</li>
<li><strong>Add layers.</strong> Add titles? Add a caption? Change the colour palette? Change the theme?</li>
</ol>
<div class="hint-terminology">
<p><strong>data</strong>: The information you want to visualise.<br />
<strong>layer</strong> collection of geometic elements and statistical transformations<br />
<strong>aesthetic attributes</strong>: color, shape, size<br />
<strong>geometric objects</strong>: points, lines, bars (<strong>geom</strong> for short)<br />
<strong>statistical transformation</strong>: summary of the data (e.g. binning in a histogram) (<strong>stat</strong> for short)<br />
<strong>mapping</strong>: description of how the variables are mapped to aesthetic attributes<br />
<strong>facet</strong>: how to break up and display subsets of data<br />
<strong>theme</strong>: the finer points of display, like font size and background colour</p>
</div>
<div class="hint-goals">
<p><strong>Example Question</strong><br />
What is the relationship between CCR5 and HLA-DR percentages in human tissues?</p>
</div>
<div id="scatterplot" class="section level3 hasAnchor">
<h3>Scatterplot<a href="chapter-5-data-visualisation-with-ggplot2.html#scatterplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using this example we’ll look at how the percentage of CCR5 and HLA-DR are correlated in this dataset.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb89-1" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;~/Desktop/analysis-user-group/&quot;</span>) </span>
<span id="cb89-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb89-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;~/Desktop/analysis-user-group/synthetic_data.csv&quot;</span>) </span></code></pre></div>
</details>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb90-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb90-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb90-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb90-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb90-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb90-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percent_CCR5, <span class="at">y =</span> percent_HLADR))<span class="sc">+</span></span>
<span id="cb90-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb90-5" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<details>
<summary>
<strong>You don’t need to use pipes for ggplot:</strong>
</summary>
<p>This will also work:</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb91-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb91-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb91-2" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4)</span>
<span id="cb91-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb91-3" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> percent_CCR5, <span class="at">y =</span> percent_HLADR))<span class="sc">+</span></span>
<span id="cb91-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb91-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
</details>
<p><e></p>
</details>
<p>Lets start with a few aesthetic things. I’ll build these sequentially and point out what is changing each time.</p>
<details>
<summary>
<strong>Change the titles and axes:</strong>
</summary>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb92-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb92-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb92-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb92-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb92-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb92-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percent_CCR5, <span class="at">y =</span> percent_HLADR))<span class="sc">+</span></span>
<span id="cb92-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb92-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb92-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb92-6" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Add a title using ggtitle()&quot;</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb93-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb93-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb93-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb93-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb93-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb93-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percent_CCR5, <span class="at">y =</span> percent_HLADR))<span class="sc">+</span></span>
<span id="cb93-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb93-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb93-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb93-6" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Change the axes with xlab() and ylab()&quot;</span>)<span class="sc">+</span></span>
<span id="cb93-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb93-7" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;CCR5 %&quot;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;HLA-DR %&quot;</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-33-2.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb94-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb94-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb94-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb94-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb94-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb94-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percent_CCR5, <span class="at">y =</span> percent_HLADR))<span class="sc">+</span></span>
<span id="cb94-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb94-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb94-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb94-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Or use `labs()` to change all at once&quot;</span>, <span class="at">x=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">y=</span> <span class="st">&quot;HLA-DR %&quot;</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-33-3.png" width="672" /></p>
<e>
</details>
<details>
<summary>
<strong>Change the overall layout:</strong>
</summary>
<p>Use <code>theme_</code> to test out different styles. Here are my three most commonly used.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb95-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb95-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb95-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb95-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb95-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb95-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percent_CCR5, <span class="at">y =</span> percent_HLADR))<span class="sc">+</span></span>
<span id="cb95-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb95-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb95-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb95-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;theme_classic()&quot;</span>, <span class="at">x=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">y=</span> <span class="st">&quot;HLA-DR %&quot;</span>)<span class="sc">+</span></span>
<span id="cb95-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb95-7" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb96-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb96-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb96-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb96-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb96-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb96-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percent_CCR5, <span class="at">y =</span> percent_HLADR))<span class="sc">+</span></span>
<span id="cb96-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb96-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb96-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb96-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;theme_minimal())&quot;</span>, <span class="at">x=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">y=</span> <span class="st">&quot;HLA-DR %&quot;</span>)<span class="sc">+</span></span>
<span id="cb96-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb96-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-34-2.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb97-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb97-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb97-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb97-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb97-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb97-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb97-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> percent_CCR5, <span class="at">y =</span> percent_HLADR))<span class="sc">+</span></span>
<span id="cb97-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb97-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb97-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb97-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;theme_bw()&quot;</span>, <span class="at">x=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">y=</span> <span class="st">&quot;HLA-DR %&quot;</span>)<span class="sc">+</span></span>
<span id="cb97-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb97-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-34-3.png" width="672" /></p>
<e>
</details>
<details>
<summary>
<strong>Adjust the aesthetic attributes (categorical):</strong>
</summary>
<p>Changing the aesthetic will let us pull more information from the simple black dots</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb98-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb98-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb98-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb98-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb98-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb98-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb98-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb98-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb98-5" tabindex="-1"></a>    <span class="at">x =</span> percent_CCR5, </span>
<span id="cb98-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb98-6" tabindex="-1"></a>    <span class="at">y =</span> percent_HLADR,</span>
<span id="cb98-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb98-7" tabindex="-1"></a>    <span class="at">color =</span> tissue</span>
<span id="cb98-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb98-8" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb98-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb98-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb98-10"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb98-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Color by tissue&quot;</span>, <span class="at">x=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">y=</span> <span class="st">&quot;HLA-DR %&quot;</span>)<span class="sc">+</span></span>
<span id="cb98-11"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb98-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb99-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb99-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb99-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb99-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb99-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb99-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb99-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb99-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb99-5" tabindex="-1"></a>    <span class="at">x =</span> percent_CCR5, </span>
<span id="cb99-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb99-6" tabindex="-1"></a>    <span class="at">y =</span> percent_HLADR,</span>
<span id="cb99-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb99-7" tabindex="-1"></a>    <span class="at">color =</span> tissue</span>
<span id="cb99-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb99-8" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb99-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb99-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb99-10"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb99-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Color by layer&quot;</span>, <span class="at">x=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">y=</span> <span class="st">&quot;HLA-DR %&quot;</span>)<span class="sc">+</span></span>
<span id="cb99-11"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb99-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-35-2.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb100-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb100-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb100-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb100-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb100-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb100-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb100-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb100-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb100-5" tabindex="-1"></a>    <span class="at">x =</span> percent_CCR5, </span>
<span id="cb100-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb100-6" tabindex="-1"></a>    <span class="at">y =</span> percent_HLADR,</span>
<span id="cb100-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb100-7" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">paste0</span>(tissue, <span class="st">&quot;_&quot;</span>, layer)</span>
<span id="cb100-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb100-8" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb100-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb100-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb100-10"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb100-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Color by tissue &amp; layer&quot;</span>, <span class="at">x=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">y=</span> <span class="st">&quot;HLA-DR %&quot;</span>)<span class="sc">+</span></span>
<span id="cb100-11"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb100-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-35-3.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb101-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb101-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb101-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb101-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-5" tabindex="-1"></a>    <span class="at">x =</span> percent_CCR5, </span>
<span id="cb101-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-6" tabindex="-1"></a>    <span class="at">y =</span> percent_HLADR,</span>
<span id="cb101-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-7" tabindex="-1"></a>    <span class="at">color =</span> tissue, </span>
<span id="cb101-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-8" tabindex="-1"></a>    <span class="at">shape =</span> layer</span>
<span id="cb101-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-9" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb101-10"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb101-11"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Color by tissue &amp; shape by layer&quot;</span>, <span class="at">x=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">y=</span> <span class="st">&quot;HLA-DR %&quot;</span>)<span class="sc">+</span></span>
<span id="cb101-12"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb101-12" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-35-4.png" width="672" /></p>
<e>
</details>
<details>
<summary>
<strong>Adjust the aesthetic attributes (continuous):</strong>
</summary>
<p>We could add a third dimension here. X and Y are the percentage values, but what if we coloured the points by a third continuous value?</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb102-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb102-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb102-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb102-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb102-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb102-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb102-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb102-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb102-5" tabindex="-1"></a>    <span class="at">x =</span> percent_CCR5, </span>
<span id="cb102-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb102-6" tabindex="-1"></a>    <span class="at">y =</span> percent_HLADR,</span>
<span id="cb102-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb102-7" tabindex="-1"></a>    <span class="at">color =</span> CCR5_MFI</span>
<span id="cb102-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb102-8" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb102-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb102-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb102-10"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb102-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Color by CCR5 MFI&quot;</span>, <span class="at">x=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">y=</span> <span class="st">&quot;HLA-DR %&quot;</span>)<span class="sc">+</span></span>
<span id="cb102-11"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb102-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb103-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb103-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb103-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4,</span>
<span id="cb103-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb103-3" tabindex="-1"></a>         <span class="at">percent_HLADR =</span> <span class="dv">100</span><span class="sc">*</span>HLADR<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb103-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb103-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb103-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb103-5" tabindex="-1"></a>    <span class="at">x =</span> percent_CCR5, </span>
<span id="cb103-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb103-6" tabindex="-1"></a>    <span class="at">y =</span> percent_HLADR,</span>
<span id="cb103-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb103-7" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">log</span>(CCR5_MFI)</span>
<span id="cb103-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb103-8" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb103-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb103-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb103-10"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb103-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Color by log(CCR5 MFI)&quot;</span>, <span class="at">x=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">y=</span> <span class="st">&quot;HLA-DR %&quot;</span>)<span class="sc">+</span></span>
<span id="cb103-11"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb103-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-36-2.png" width="672" /></p>
<e>
</details>
<p><wimr></p>
<div class="hint-goals">
<p><strong>Example Question</strong><br />
Which tissues are enriched for CCR5?</p>
</div>
</div>
<div id="boxplot" class="section level3 hasAnchor">
<h3>Boxplot<a href="chapter-5-data-visualisation-with-ggplot2.html#boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details>
<summary>
<strong>Boxplot vs Violin:</strong>
</summary>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb104-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb104-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb104-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb104-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb104-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb104-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb104-4" tabindex="-1"></a>    <span class="at">x =</span> group, </span>
<span id="cb104-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb104-5" tabindex="-1"></a>    <span class="at">y =</span> percent_CCR5</span>
<span id="cb104-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb104-6" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb104-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb104-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb104-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb104-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;geom_boxplot()&quot;</span>, <span class="at">y=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">x=</span> <span class="st">&quot;Tissue x Layer&quot;</span>)<span class="sc">+</span></span>
<span id="cb104-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb104-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb105-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb105-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb105-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb105-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb105-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>( </span>
<span id="cb105-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb105-4" tabindex="-1"></a>    <span class="at">x =</span> group, </span>
<span id="cb105-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb105-5" tabindex="-1"></a>    <span class="at">y =</span> percent_CCR5</span>
<span id="cb105-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb105-6" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb105-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb105-7" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb105-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb105-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;geom_violin()&quot;</span>, <span class="at">y=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">x=</span> <span class="st">&quot;Tissue x Layer&quot;</span>)<span class="sc">+</span></span>
<span id="cb105-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb105-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-37-2.png" width="672" /></p>
<e>
</details>
<details>
<summary>
<strong>Combining layers - boxplot &amp; points:</strong>
</summary>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb106-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb106-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb106-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb106-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb106-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb106-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb106-4" tabindex="-1"></a>    <span class="at">x =</span> group, </span>
<span id="cb106-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb106-5" tabindex="-1"></a>    <span class="at">y =</span> percent_CCR5</span>
<span id="cb106-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb106-6" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb106-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb106-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb106-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb106-8" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb106-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb106-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;geom_boxplot() AND geom_point()&quot;</span>, <span class="at">y=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">x=</span> <span class="st">&quot;Tissue x Layer&quot;</span>)<span class="sc">+</span></span>
<span id="cb106-10"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb106-10" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb107-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb107-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb107-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb107-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb107-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb107-4" tabindex="-1"></a>    <span class="at">x =</span> group, </span>
<span id="cb107-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb107-5" tabindex="-1"></a>    <span class="at">y =</span> percent_CCR5</span>
<span id="cb107-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb107-6" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb107-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb107-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb107-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb107-8" tabindex="-1"></a>  <span class="fu">geom_jitter</span>()<span class="sc">+</span></span>
<span id="cb107-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb107-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;geom_boxplot() AND geom_jitter()&quot;</span>, <span class="at">y=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">x=</span> <span class="st">&quot;Tissue x Layer&quot;</span>)<span class="sc">+</span></span>
<span id="cb107-10"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb107-10" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-38-2.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb108-1" tabindex="-1"></a><span class="co"># The default jitter is width = 0.5 - we can reduce this </span></span>
<span id="cb108-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb108-2" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb108-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb108-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb108-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb108-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb108-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb108-5" tabindex="-1"></a>    <span class="at">x =</span> group, </span>
<span id="cb108-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb108-6" tabindex="-1"></a>    <span class="at">y =</span> percent_CCR5</span>
<span id="cb108-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb108-7" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb108-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb108-8" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb108-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb108-9" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb108-10"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb108-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;geom_boxplot() AND geom_jitter(width=0.1)&quot;</span>, <span class="at">y=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">x=</span> <span class="st">&quot;Tissue x Layer&quot;</span>)<span class="sc">+</span></span>
<span id="cb108-11"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb108-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<e>
</details>
<details>
<summary>
<strong>Adjusting the aestheticss:</strong>
</summary>
<p>When you’re combining layers, like boxplot and point, you might want to change the aesthetic to each layer individually. So instead of changing the aes at the start, we can add aes inside the geom’s.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb109-1" tabindex="-1"></a><span class="co"># The default jitter is width = 0.5 - we can reduce this </span></span>
<span id="cb109-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb109-2" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb109-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CCR5 =</span> <span class="dv">100</span><span class="sc">*</span>CCR5<span class="sc">/</span>CD4) <span class="sc">%&gt;%</span></span>
<span id="cb109-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb109-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb109-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb109-5" tabindex="-1"></a>    <span class="at">x =</span> group, </span>
<span id="cb109-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb109-6" tabindex="-1"></a>    <span class="at">y =</span> percent_CCR5</span>
<span id="cb109-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb109-7" tabindex="-1"></a>  ))<span class="sc">+</span></span>
<span id="cb109-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb109-8" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> group)) <span class="sc">+</span> </span>
<span id="cb109-9"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb109-9" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.1</span>, <span class="fu">aes</span>(<span class="at">color=</span>age))<span class="sc">+</span></span>
<span id="cb109-10"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb109-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;geom_boxplot(aes(fill=group))+geom_jitter(aes(color=age))&quot;</span>, <span class="at">y=</span> <span class="st">&quot;CCR5 %&quot;</span>, <span class="at">x=</span> <span class="st">&quot;Tissue x Layer&quot;</span>)<span class="sc">+</span></span>
<span id="cb109-11"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb109-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<e>
</details>
<p><wimr></p>
<div class="hint-goals">
<p><strong>Example Question</strong><br />
What is the ratio of CD4:CD8 per tissue and layer?</p>
</div>
</div>
<div id="columnbar-graph" class="section level3 hasAnchor">
<h3>Column/bar graph<a href="chapter-5-data-visualisation-with-ggplot2.html#columnbar-graph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Column/bar graphs are useful for summary graphs and/or statistical transformations (such as counts or histograms).</p>
<details>
<summary>
<strong>Column graph:</strong>
</summary>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb110-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb110-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ratio =</span> <span class="fu">log</span>(CD4<span class="sc">/</span>CD8)) <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb110-3" tabindex="-1"></a>  <span class="fu">group_by</span>(group)<span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb110-4" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">meanratio =</span> <span class="fu">mean</span>(ratio))<span class="sc">%&gt;%</span></span>
<span id="cb110-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb110-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Predominant Subset</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(meanratio<span class="sc">&lt;</span><span class="dv">0</span>, <span class="st">&quot;CD8&quot;</span>, <span class="st">&quot;CD4&quot;</span>))<span class="sc">%&gt;%</span></span>
<span id="cb110-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb110-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>meanratio, <span class="at">fill=</span><span class="st">`</span><span class="at">Predominant Subset</span><span class="st">`</span>))<span class="sc">+</span></span>
<span id="cb110-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb110-7" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb110-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb110-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
</details>
<details>
<summary>
<strong>Example of statistical transformations (Histogram/Bar graph):</strong>
</summary>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb111-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span>   </span>
<span id="cb111-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb111-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CD4 =</span> <span class="dv">100</span><span class="sc">*</span>CD4<span class="sc">/</span>CD3,</span>
<span id="cb111-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb111-3" tabindex="-1"></a>         <span class="at">percent_CD8 =</span> <span class="dv">100</span><span class="sc">*</span>CD8<span class="sc">/</span>CD3) <span class="sc">%&gt;%</span></span>
<span id="cb111-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb111-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>percent_CD4))<span class="sc">+</span></span>
<span id="cb111-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb111-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()<span class="sc">+</span></span>
<span id="cb111-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb111-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb111-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb111-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Histogram example&quot;</span>)</span></code></pre></div>
</details>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb113-1" tabindex="-1"></a><span class="co"># change the bin width to add more resolution</span></span>
<span id="cb113-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb113-2" tabindex="-1"></a>data <span class="sc">%&gt;%</span>   </span>
<span id="cb113-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb113-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent_CD4 =</span> <span class="dv">100</span><span class="sc">*</span>CD4<span class="sc">/</span>CD3,</span>
<span id="cb113-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb113-4" tabindex="-1"></a>         <span class="at">percent_CD8 =</span> <span class="dv">100</span><span class="sc">*</span>CD8<span class="sc">/</span>CD3) <span class="sc">%&gt;%</span></span>
<span id="cb113-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb113-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>percent_CD4))<span class="sc">+</span></span>
<span id="cb113-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb113-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> .<span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb113-7"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb113-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb113-8"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb113-8" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Histogram example&quot;</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-42-2.png" width="672" /></p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb114-1" tabindex="-1"></a>data <span class="sc">%&gt;%</span>   </span>
<span id="cb114-2"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb114-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">predominant =</span> <span class="fu">ifelse</span>(CD4<span class="sc">&gt;</span>CD8, <span class="st">&quot;CD4&quot;</span>, <span class="st">&quot;CD8&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb114-3"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb114-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>predominant))<span class="sc">+</span></span>
<span id="cb114-4"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb114-4" tabindex="-1"></a>  <span class="fu">geom_bar</span>()<span class="sc">+</span></span>
<span id="cb114-5"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb114-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb114-6"><a href="chapter-5-data-visualisation-with-ggplot2.html#cb114-6" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bar graph example: Number of samples that are predominantly CD4 or CD8&quot;</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-42-3.png" width="672" /></p>
<e>
</details>
</div>
</div>
<div id="summary" class="section level2 hasAnchor">
<h2>Summary<a href="chapter-5-data-visualisation-with-ggplot2.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With these simple examples, you should have an idea of how to make and customise ggplots for your data.</p>
<p>The next chapter will build upon these, such as changing the theme elements, customising the colours, combining and then saving your plots.</p>
<p><a href="https://drthomasoneil.github.io/analysis-user-group/r-tutorial/_book/chapter-6-data-visualisation-with-ggplot2-2.html">Next chapter →</a></p>
<div id="quote-box" style="text-align:center; font-style:italic; margin-top:20px; margin-bottom:20px;">

</div>

</div>
</div>
<div class="custom-footer">
  <div class="footer-left" style="width: 30%; float: centre">
    <img src="assets/footer/footer1.png" alt="wimr-logo">
  </div>
  <div class="footer-center">
    <p><strong>Site Creators</strong><br>
      Thomas O'Neil<br>
      Harry Robertson<br>
      <a href="mailto:thomas.oneil@sydney.edu.au"><strong>Contact us</strong></a>
    </p>
  </div>
  <div class="footer-right" style="width: 30%; float: centre">
    <img src="assets/footer/footer2.png" alt="usyd-logo">
  </div>
</div>
<div class="footer-updated">
  <p>This site was last updated</p>
  <p><script>document.write(new Date().toISOString().slice(0, 10));</script></p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-4-data-manipulation-with-tidyverse.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-6-data-visualisation-with-ggplot2-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
